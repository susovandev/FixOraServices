<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>

  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    /* Hide scrollbar but keep swipe */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;  /* IE & Edge */
      scrollbar-width: none;     /* Firefox */
    }

  </style>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
  />
  
</head>

<body>
<%- include("../partials/toast.ejs") %>
<!-- TOAST CONTAINER -->
<div
  id="toastContainer"
  class="fixed top-6 right-6 z-[9999] space-y-3"
></div>
<!-- Header -->
<header class="sticky top-0 z-50 bg-white border-b">
  <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
    <!-- Logo -->
    <div class="flex items-center gap-2">
      <img src="/assets/logo.png" class="h-8" alt="FixOra Logo" />
      <span class="font-semibold text-lg">
        FixOra <span class="font-normal text-gray-600">Services</span>
      </span>
    </div>

    <!-- Nav -->
    <nav class="hidden md:flex gap-6 text-sm font-medium">
      <a href="#" class="hover:text-black">Revamp</a>
      <a href="#" class="hover:text-black">Native</a>
      <a href="#" class="hover:text-black">Beauty</a>
    </nav>

    <!-- Actions -->
    <div class="flex items-center gap-4 relative">
      <!-- Location (future live) -->
      <button
        class="hidden lg:flex items-center gap-1 text-sm text-gray-600 hover:text-black"
        id="location-btn"
      >
        <i data-lucide="map-pin" class="w-4 h-4"></i>
        <span id="location-text">Dadar, Mumbai</span>
      </button>

      <!-- Search -->
      <div class="relative hidden md:block">
        <input
          type="text"
          placeholder="Search for services"
          class="px-3 py-2 w-56 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-black"
          id="service-search"
        />

        <!-- Search Dropdown -->
        <div
          id="search-dropdown"
          class="absolute mt-2 w-full bg-white border rounded-lg shadow-lg hidden"
        >
          <!-- Dynamic items -->
          <div class="p-3 text-sm text-gray-500">Start typing to search‚Ä¶</div>
        </div>
      </div>

      <!-- Icons -->
      <div class="flex items-center gap-3">
        <button class="p-2 rounded-full hover:bg-gray-100 transition">
          <a href="/cart">
            <i class="w-5 h-5 fas fa-shopping-cart"></i>
          </a>
        </button>

<!-- Profile -->
<div class="relative">
  <button
    id="profileBtn"
    class="p-2 rounded-full hover:bg-gray-100 transition"
  >
    <i class="fas fa-user w-5 h-5"></i>
  </button>

  <!-- Dropdown -->
  <div
    id="profileDropdown"
    class="absolute right-0 mt-2 w-56 bg-white border rounded-xl shadow-lg
    opacity-0 scale-95 pointer-events-none
    transition-all duration-150 origin-top-right z-50"
  >
    <% if (!user) { %>
      <button
        id="openLoginModal"
        class="w-full text-left px-4 py-2 text-sm hover:bg-gray-50"
      >
        Login
      </button>
    <% } else { %>
      <div class="px-4 py-2 text-sm text-gray-500">
        Hi, <%= user.username %>
      </div>
      <hr />
      <a href="/dashboard" class="block px-4 py-2 text-sm hover:bg-gray-50">
        Dashboard
      </a>
      <a href="/orders" class="block px-4 py-2 text-sm hover:bg-gray-50">
        My Orders
      </a>
      <a href="/profile" class="block px-4 py-2 text-sm hover:bg-gray-50">
        Profile
      </a>
      <hr />
      <a
        href="/logout"
        class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-50"
      >
        Logout
      </a>
    <% } %>
  </div>
</div>
      </div>
  </div>
</header>
<!-- Header -->

<!-- Main -->
<main class="min-h-screen">
  <!-- HERO -->
  <!-- <section class="bg-white py-20">
    <div class="max-w-7xl mx-auto px-6 text-center">
      <h1 class="text-4xl font-bold mb-4">Premium Home Services, On Demand</h1>
      <p class="text-gray-600 max-w-xl mx-auto">
        Trusted professionals for cleaning, beauty, repairs & more
      </p>
    </div>
  </section> -->

  <!-- SHOWCASE / TRUST SECTION -->
<section class="bg-white py-20">
  <div class="max-w-7xl mx-auto px-6 grid lg:grid-cols-2 gap-14 items-center">

    <!-- LEFT CONTENT -->
    <div>
      <h2 class="text-4xl font-bold leading-tight mb-6">
        Home services at your <br class="hidden sm:block" />
        doorstep
      </h2>

      <!-- Search Box (optional, matches hero vibe) -->
      <div class="bg-white border rounded-xl p-4 shadow-sm mb-8">
        <p class="text-sm text-gray-500 mb-3">
          What are you looking for?
        </p>

        <div class="flex flex-wrap gap-3">
          <button
            class="flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg text-sm hover:bg-gray-200 transition"
          >
            <i class="fas fa-water"></i>
            Native Water Purifier
          </button>

          <button
            class="flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg text-sm hover:bg-gray-200 transition"
          >
            <i class="fas fa-shopping-bag"></i>
            Buy Native Products
          </button>
        </div>
      </div>

      <!-- STATS -->
      <div class="flex gap-10">
        <div class="flex items-center gap-3">
          <div class="p-3 bg-gray-100 rounded-full">
            ‚≠ê
          </div>
          <div>
            <p class="font-semibold">4.8</p>
            <p class="text-sm text-gray-500">Service Rating</p>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <div class="p-3 bg-gray-100 rounded-full">
            üë•
          </div>
          <div>
            <p class="font-semibold">12M+</p>
            <p class="text-sm text-gray-500">Customers Globally</p>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT IMAGE GRID -->
    <div class="grid grid-cols-2 gap-4">
      <!-- Replace src with your own images -->
      <img
        src="https://plus.unsplash.com/premium_photo-1683121705485-e0c26875489e?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
        class="rounded-xl object-cover w-full h-full"
        alt="Service Image 1"
      />

      <img
        src="https://plus.unsplash.com/premium_photo-1683120897865-b09acb266810?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
        class="rounded-xl object-cover w-full h-full"
        alt="Service Image 2"
      />

      <img
        src="https://plus.unsplash.com/premium_photo-1680297038160-89157d0c56d4?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
        class="rounded-xl object-cover w-full h-full col-span-1"
        alt="Service Image 3"
      />

      <img
        src="https://images.unsplash.com/photo-1749532125405-70950966b0e5?q=80&w=1171&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
        class="rounded-xl object-cover w-full h-full col-span-1"
        alt="Service Image 4"
      />
    </div>

  </div>
</section>


  <!-- POPULAR SERVICES -->
<section class="py-20">
  <div class="max-w-7xl mx-auto px-6">
    <div class="mb-10">
      <h2 class="text-3xl font-semibold">Popular Services</h2>
      <p class="text-gray-600 mt-1">
        of our finest experiences
      </p>
    </div>

    <div  class="flex gap-6 overflow-x-auto scroll-smooth
    snap-x snap-mandatory no-scrollbar overscroll-x-contain touch-pan-x p-4"> 
      <% 
      const popularServices = [
        { _id: 1, title: 'Wall Panels', image:"https://plus.unsplash.com/premium_photo-1681491722984-1fb4e1b326bb?q=80&w=687&auto=format&fit=crop", price:299 },
        { _id: 1, title: 'Bathroom Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1683141366824-34b1e148f7bd?q=80&w=687&auto=format&fit=crop", price:399 },
        { _id: 1, title: 'Kitchen Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1677686007410-eebf392e3fbd?q=80&w=687&auto=format&fit=crop", price:599 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683121328013-f9efabdabde5?q=80&w=1170&auto=format&fit=crop", price:199 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683140911652-9eccabee148f?q=80&w=1170&auto=format&fit=crop", price:99 },
        { _id: 1, title: 'Wall Panels', image:"https://plus.unsplash.com/premium_photo-1681491722984-1fb4e1b326bb?q=80&w=687&auto=format&fit=crop", price:299 },
        { _id: 1, title: 'Bathroom Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1683141366824-34b1e148f7bd?q=80&w=687&auto=format&fit=crop", price:399 },
        { _id: 1, title: 'Kitchen Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1677686007410-eebf392e3fbd?q=80&w=687&auto=format&fit=crop", price:599 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683121328013-f9efabdabde5?q=80&w=1170&auto=format&fit=crop", price:199 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683140911652-9eccabee148f?q=80&w=1170&auto=format&fit=crop", price:99 },
        { _id: 1, title: 'Wall Panels', image:"https://plus.unsplash.com/premium_photo-1681491722984-1fb4e1b326bb?q=80&w=687&auto=format&fit=crop", price:299 },
        { _id: 1, title: 'Bathroom Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1683141366824-34b1e148f7bd?q=80&w=687&auto=format&fit=crop", price:399 },
        { _id: 1, title: 'Kitchen Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1677686007410-eebf392e3fbd?q=80&w=687&auto=format&fit=crop", price:599 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683121328013-f9efabdabde5?q=80&w=1170&auto=format&fit=crop", price:199 },
        { _id: 1, title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683140911652-9eccabee148f?q=80&w=1170&auto=format&fit=crop", price:99 },
      ];
    %>

    <!-- GRID SHOULD BE HERE -->
  <% popularServices.forEach(ps => { %>

<a href="<%= ps._id %>">
  <div
  class="relative min-w-[260px] rounded-2xl overflow-hidden
  cursor-pointer shadow-sm hover:shadow-lg transition
  snap-start"
>

  <!-- Image -->
  <div class="aspect-[4/5] bg-gray-100">
    <img
      src="<%= ps.image %>"
      alt="<%= ps.title %>"
      class="w-full h-full object-cover"
    />
  </div>

  <!-- Content -->
  <div class="p-4 space-y-2">

    <!-- Title -->
    <h3 class="text-base font-semibold leading-tight">
      <%= ps.title %>
    </h3>

    <!-- Rating + Instant -->
    <div class="flex items-center gap-2 text-sm text-gray-600">
      <span class="flex items-center gap-1">
        ‚≠ê <span class="font-medium">4.73</span>
      </span>

      <span class="w-1 h-1 bg-gray-400 rounded-full"></span>

      <span class="flex items-center gap-1 text-green-600 font-medium">
        ‚ö° Instant
      </span>
    </div>

    <!-- Price -->
    <p class="text-sm font-medium">
      ‚Çπ<%= ps.price %>
    </p>

  </div>
</div>
</a>


  <% }); %>
</div>
</div>
</section>


  <!-- VIDEO PROOF / CURATIONS -->
<section class="py-20 bg-white">
  <div class="max-w-7xl mx-auto px-6">

    <!-- Heading -->
    <div class="mb-10">
      <h2 class="text-3xl font-semibold">Thoughtful curations</h2>
      <p class="text-gray-600 mt-1">
        of our finest experiences
      </p>
    </div>

    <!-- Video Slider -->
    <div  class="flex gap-6 overflow-x-auto scroll-smooth
  snap-x snap-mandatory
  no-scrollbar
  overscroll-x-contain touch-pan-x">

      <% 
        const videos = [
          { title: 'Wall Panels', image:"https://plus.unsplash.com/premium_photo-1681491722984-1fb4e1b326bb?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",  video: 'videos/wall-panels.mp4' },
          { title: 'Bathroom Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1683141366824-34b1e148f7bd?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",  video: 'videos/bathroom.mp4' },
          { title: 'Kitchen Deep Cleaning', image:"https://plus.unsplash.com/premium_photo-1677686007410-eebf392e3fbd?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", video: 'videos/kitchen.mp4' },
          { title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683121328013-f9efabdabde5?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", video: 'videos/painting.mp4' },
          { title: 'Painting & Waterproofing', image:"https://plus.unsplash.com/premium_photo-1683140911652-9eccabee148f?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", video: 'videos/painting.mp4' },
        ];
      %>

      <% videos.forEach(v => { %>
        <div
        class="relative min-w-[260px] h-[420px] rounded-2xl overflow-hidden
  cursor-pointer group shadow-sm hover:shadow-lg transition
  snap-start"
  onclick="openVideo('<%= v.video %>')"
        >

          <img
            src="<%= v.image %>"
            alt="<%= v.title %>"
            class="w-full h-full object-cover"
          />

          <!-- Dark overlay -->
          <div class="absolute inset-0 bg-black/20"></div>

          <!-- Play Button -->
          <div
            class="absolute inset-0 flex items-center justify-center"
          >
            <div
              class="w-16 h-16 rounded-full bg-white/90
              flex items-center justify-center
              group-hover:scale-110 transition"
            >
              <i class="fas fa-play text-black ml-1"></i>
            </div>
          </div>

          <!-- Title -->
          <div class="absolute bottom-4 left-4 right-4">
            <p class="text-white text-xl font-semibold leading-snug">
              <%= v.title %>
            </p>
          </div>
        </div>
      <% }) %>

    </div>
  </div>
</section>


  <!-- APPLIANCE SERVICES -->
<section class="py-10 bg-white">
  <div class="max-w-7xl mx-auto px-6">

    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
      <h2 class="text-3xl font-semibold">
        Appliance Service & Repair
      </h2>

      <div class="flex items-center gap-3">
        <a
          href="/services/appliances"
          class="hidden sm:inline-flex text-sm font-medium text-indigo-600 hover:underline"
        >
          See all
        </a>
      </div>
    </div>

    <!-- Slider -->
    <div
      id="applianceSlider"
      class="flex gap-6 overflow-x-auto scroll-smooth
      snap-x snap-mandatory
      no-scrollbar
      overscroll-x-contain touch-pan-x"
    >
      <% 
        const appliances = [
          'AC',
          'Washing Machine',
          'Geyser',
          'Laptop',
          'Television',
          'Refrigerator',
          'Microwave',
          'Water Purifier'
        ];
      %>

      <% appliances.forEach(name => { %>
        <div
          class="min-w-[220px] bg-white border rounded-2xl
          hover:shadow-md transition cursor-pointer"
        >
          <div
            class="h-40 rounded-t-2xl bg-gradient-to-b from-white to-emerald-50
            flex items-center justify-center"
          >
            <!-- Replace image later -->
            <img
              src="/assets/placeholder.png"
              alt="<%= name %>"
              class="h-28 object-contain"
            />
          </div>

          <div class="p-4">
            <p class="font-medium text-center"><%= name %></p>
          </div>
        </div>
      <% }) %>
    </div>

  </div>
</section>

<!-- FIRST PROMOTIONAL BANNER -->
<section class="py-10">
  <div
    class="max-w-7xl mx-auto px-6"
  >
    <div
      class="relative overflow-hidden rounded-3xl
      bg-gradient-to-r from-slate-900 via-slate-800 to-black
      text-white"
    >
      <!-- Background Image (optional, replace later) -->
      <img
        src="/assets/promo-bg.jpg"
        alt="Promotion Background"
        class="absolute inset-0 w-full h-full object-cover opacity-40"
      />

      <div
        class="relative z-10 grid md:grid-cols-2 gap-10
        items-center px-10 py-14"
      >
        <!-- LEFT CONTENT -->
        <div>
          <!-- Discount Badge -->
          <span
            class="inline-block mb-4 px-4 py-1.5
            bg-emerald-600 text-sm font-medium rounded-full"
          >
            Up to ‚Çπ2,800 off
          </span>

          <!-- Brand -->
          <p class="tracking-widest text-sm text-gray-300 mb-3">
            NATIVE
          </p>

          <!-- Heading -->
          <h2 class="text-4xl font-bold mb-4 leading-tight">
            Smart locks
          </h2>

          <!-- Subtext -->
          <p class="text-gray-300 text-lg mb-8">
            Camera. Doorbell. All-in one.
          </p>

          <!-- CTA -->
          <a
            href="/products/smart-locks"
            class="inline-block bg-white text-black
            px-8 py-3 rounded-xl font-medium
            hover:bg-gray-100 transition"
          >
            Buy now
          </a>
        </div>

        <!-- RIGHT IMAGE -->
        <div class="relative flex justify-center md:justify-end">
          <!-- Replace image later -->
          <img
            src="/assets/smart-lock.png"
            alt="Smart Lock"
            class="max-h-[420px] object-contain drop-shadow-2xl"
          />
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SECOND PROMOTIONAL BANNER -->
<section class="py-10">
  <div
    class="max-w-7xl mx-auto px-6"
  >
    <div
      class="relative overflow-hidden rounded-3xl
      bg-gradient-to-r from-slate-900 via-slate-800 to-black
      text-white"
    >
      <!-- Background Image (optional, replace later) -->
      <img
        src="/assets/promo-bg.jpg"
        alt="Promotion Background"
        class="absolute inset-0 w-full h-full object-cover opacity-40"
      />

      <div
        class="relative z-10 grid md:grid-cols-2 gap-10
        items-center px-10 py-14"
      >
        <!-- LEFT CONTENT -->
        <div>
          <!-- Discount Badge -->
          <span
            class="inline-block mb-4 px-4 py-1.5
            bg-emerald-600 text-sm font-medium rounded-full"
          >
            Up to ‚Çπ2,800 off
          </span>

          <!-- Brand -->
          <p class="tracking-widest text-sm text-gray-300 mb-3">
            NATIVE
          </p>

          <!-- Heading -->
          <h2 class="text-4xl font-bold mb-4 leading-tight">
            Smart locks
          </h2>

          <!-- Subtext -->
          <p class="text-gray-300 text-lg mb-8">
            Camera. Doorbell. All-in one.
          </p>

          <!-- CTA -->
          <a
            href="/products/smart-locks"
            class="inline-block bg-white text-black
            px-8 py-3 rounded-xl font-medium
            hover:bg-gray-100 transition"
          >
            Buy now
          </a>
        </div>

        <!-- RIGHT IMAGE -->
        <div class="relative flex justify-center md:justify-end">
          <!-- Replace image later -->
          <img
            src="/assets/smart-lock.png"
            alt="Smart Lock"
            class="max-h-[420px] object-contain drop-shadow-2xl"
          />
        </div>
      </div>
    </div>
  </div>
</section>

  <!-- WHY US -->
  <section class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-6 grid md:grid-cols-3 gap-10">
      <div>
        <h3 class="font-semibold text-lg mb-2">Verified Experts</h3>
        <p class="text-gray-600 text-sm">Background-checked professionals</p>
      </div>
      <div>
        <h3 class="font-semibold text-lg mb-2">Transparent Pricing</h3>
        <p class="text-gray-600 text-sm">No hidden charges</p>
      </div>
      <div>
        <h3 class="font-semibold text-lg mb-2">Quick Support</h3>
        <p class="text-gray-600 text-sm">24√ó7 customer assistance</p>
      </div>
    </div>
  </section>
</main>
<!-- Main -->

<!-- Footer -->
<footer class="bg-gray-100 mt-20">
  <div class="max-w-7xl mx-auto px-6 py-16 grid md:grid-cols-4 gap-10">

    <!-- Company -->
    <div>
      <h4 class="font-semibold mb-4">FixOraServices</h4>
      <ul class="space-y-2 text-sm text-gray-600">
        <li><a href="/about">About us</a></li>
        <li><a href="/career">Careers</a></li>
        <li><a href="/terms">Terms & Conditions</a></li>
        <li><a href="/privacy">Privacy Policy</a></li>
      </ul>
    </div>

    <!-- Customers -->
    <div>
      <h4 class="font-semibold mb-4">For Customers</h4>
      <ul class="space-y-2 text-sm text-gray-600">
        <li>Categories near you</li>
        <li><a href="/reviews">Reviews</a></li>
        <li><a href="/contact">Contact us</a></li>
      </ul>
    </div>

    <!-- Professionals -->
    <div>
      <h4 class="font-semibold mb-4">For Professionals</h4>
      <ul class="space-y-2 text-sm text-gray-600">
        <li><a href="/register">Register as a professional</a></li>
      </ul>
    </div>

    <!-- Social -->
    <div>
      <h4 class="font-semibold mb-4">Social</h4>
      <div class="flex gap-3">
        <span class="p-2 bg-white rounded-full shadow">üê¶</span>
        <span class="p-2 bg-white rounded-full shadow">üìò</span>
        <span class="p-2 bg-white rounded-full shadow">üì∏</span>
        <span class="p-2 bg-white rounded-full shadow">üîó</span>
      </div>
    </div>

  </div>

  <div class="border-t text-center text-sm text-gray-500 py-6">
    ¬© 2026 FixOraServices. All rights reserved.
  </div>
</footer>
<!-- Footer -->



<!-- LOGIN MODAL -->
<div
  id="loginModal"
  class="fixed inset-0 z-50 hidden items-center justify-center"
>
  <!-- Backdrop -->
  <div
    class="absolute inset-0 bg-black/40 backdrop-blur-sm"
    id="loginBackdrop"
  ></div>

  <!-- Modal Box -->
  <div
    id="loginBox"
  class="relative bg-white w-full max-w-md mt-6 mr-6 rounded-2xl shadow-xl
  p-6 transform translate-y-2 opacity-0 transition-all duration-200"
  >
    <!-- Close -->
    <button
      id="closeLoginModal"
      class="absolute top-4 right-4 text-gray-400 hover:text-black"
    >
      <i  class="w-5 h-5 fas fa-times"></i>
    </button>

    <!-- Content -->
    <h2 class="text-xl font-semibold mb-1">Login</h2>
    <p class="text-sm text-gray-500 mb-6">
      Enter your phone number to continue
    </p>

    <!-- Phone Input -->
    <form id="loginForm" method="POST" class="space-y-4">
      <div>
        <label class="block text-sm font-medium mb-1">
          Phone Number
        </label>
        <div class="flex gap-2">
          <span class="flex items-center px-3 border rounded-lg bg-gray-50 text-sm">
            +91
          </span>
          <input
            name="phone"
            type="tel"
            maxlength="10"
            placeholder="Enter 10 digit number"
            class="flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-black focus:outline-none"
            required
          />
        </div>
      </div>

      <button
  id="loginSubmitBtn"
  type="submit"
  class="w-full py-2.5 bg-black text-white rounded-lg
         hover:bg-gray-900 transition font-medium
         flex items-center justify-center gap-2"
>
  <span id="loginBtnText">Continue</span>

  <!-- Spinner -->
  <svg
    id="loginSpinner"
    class="hidden w-5 h-5 animate-spin text-white"
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
  >
    <circle
      class="opacity-25"
      cx="12"
      cy="12"
      r="10"
      stroke="currentColor"
      stroke-width="4"
    ></circle>
    <path
      class="opacity-75"
      fill="currentColor"
      d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
    ></path>
  </svg>
</button>
    </form>

    <!-- Footer -->
    <p class="text-xs text-gray-500 mt-4 text-center">
      By continuing, you agree to our
      <a href="#" class="underline">Terms</a> &
      <a href="#" class="underline">Privacy Policy</a>
    </p>
  </div>
</div>


<!-- OTP VERIFY MODAL -->
<div
  id="otpModal"
  class="fixed inset-0 z-50 hidden items-center justify-center"
>
  <!-- Backdrop -->
  <div class="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>

  <!-- Modal Box -->
  <div
    class="relative bg-white w-full max-w-md rounded-2xl shadow-xl p-6"
  >
    <!-- Close -->
    <button
      onclick="closeOtpModal()"
      class="absolute top-4 right-4 text-gray-400 hover:text-black"
    >
      <i class="fas fa-times"></i>
    </button>

    <!-- Header -->
    <div class="flex items-center gap-3 mb-4">
      <div class="p-2 bg-blue-100 rounded-lg">üì±</div>
      <h2 class="text-xl font-semibold">Enter verification code</h2>
    </div>

    <p class="text-sm text-gray-500 mb-6">
      A 6-digit verification code has been sent to
      <span class="font-medium" id="otpPhoneText"></span>
    </p>

    <!-- OTP INPUTS -->
<div class="flex gap-3 justify-center mb-6">
  <% for (let i = 0; i < 6; i++) { %>
    <input
      maxlength="1"
      inputmode="numeric"
      class="otp-input w-12 h-12 text-center border rounded-lg
             text-lg font-semibold focus:ring-2 focus:ring-black
             focus:outline-none"
    />
  <% } %>
</div>



    <!-- TIMER / RESEND -->
    <div class="text-center text-sm text-gray-600 mb-4">
      <span id="otpTimer">02:00</span>
      <button
  id="resendOtpBtn"
  onclick="resendOtp()"
  class="hidden text-blue-600 font-medium hover:underline"
>
  Resend OTP
</button>
    </div>

    <!-- VERIFY -->
    <button
      onclick="verifyOtp()"
      class="w-full py-2.5 bg-black text-white rounded-lg
      hover:bg-gray-900 transition font-medium"
    >
      Verify & Login
    </button>
  </div>
</div>


<!-- VIDEO MODAL -->
<div
  id="videoModal"
  class="fixed inset-0 z-50 hidden items-center justify-center"
>
  <!-- Backdrop -->
  <div
    class="absolute inset-0 bg-black/70"
    onclick="closeVideo()"
  ></div>

  <!-- Video Container -->
  <div
    class="relative z-10 w-full max-w-4xl px-4
    max-h-[85vh] flex items-center justify-center"
  >
    <!-- Video Wrapper (keeps aspect ratio) -->
    <div class="w-full aspect-video">
      <video
        id="videoPlayer"
        controls
        autoplay
        class="w-full h-full rounded-2xl bg-black object-contain"
      ></video>
    </div>

    <!-- Close Button -->
    <button
      onclick="closeVideo()"
      class="absolute -top-12 right-6 text-white text-2xl
      hover:opacity-80 transition"
    >
      ‚úï
    </button>
  </div>
</div>


<script>
document.addEventListener("DOMContentLoaded", () => {

  // Login modal
  const loginModal = document.getElementById("loginModal");
  const loginBox = document.getElementById("loginBox");
  const openLoginBtn = document.getElementById("openLoginModal");
  const closeLoginBtn = document.getElementById("closeLoginModal");
  const loginBackdrop = document.getElementById("loginBackdrop");
  const loginForm = document.getElementById("loginForm");

  // Login loader
  const loginSubmitBtn = document.getElementById("loginSubmitBtn");
  const loginBtnText = document.getElementById("loginBtnText");
  const loginSpinner = document.getElementById("loginSpinner");

  // OTP modal
  const otpModal = document.getElementById("otpModal");
  const otpPhoneText = document.getElementById("otpPhoneText");
  const otpTimerEl = document.getElementById("otpTimer");
  const resendOtpBtn = document.getElementById("resendOtpBtn");

  // Profile dropdown
  const profileBtn = document.getElementById("profileBtn");
  const profileDropdown = document.getElementById("profileDropdown");

  // Video modal
  const videoModal = document.getElementById("videoModal");
  const videoPlayer = document.getElementById("videoPlayer");

  let otpTimer = null;
  let remainingSeconds = 120;
  let currentPhone = "";
  let dropdownOpen = false;



  function openLoginModal() {
    loginModal.classList.remove("hidden");
    loginModal.classList.add("flex");

    requestAnimationFrame(() => {
      loginBox.classList.remove("translate-y-2", "opacity-0");
      loginBox.classList.add("translate-y-0", "opacity-100");
    });
  }

  function closeLoginModal() {
    loginBox.classList.add("translate-y-2", "opacity-0");
    loginBox.classList.remove("translate-y-0", "opacity-100");

    setTimeout(() => {
      loginModal.classList.add("hidden");
      loginModal.classList.remove("flex");
    }, 200);
  }

  openLoginBtn?.addEventListener("click", openLoginModal);
  closeLoginBtn?.addEventListener("click", closeLoginModal);
  loginBackdrop?.addEventListener("click", closeLoginModal);

  function setLoginLoading(loading) {
    loginSubmitBtn.disabled = loading;
    loginBtnText.innerText = loading ? "Sending OTP‚Ä¶" : "Continue";
    loginSpinner.classList.toggle("hidden", !loading);
  }

  loginForm?.addEventListener("submit", async (e) => {
    e.preventDefault();

    const phone = loginForm.phone.value.trim();
    if (phone.length !== 10) {
      showToast("error", "Enter valid phone number");
      return;
    }

    setLoginLoading(true);

    try {
      const res = await fetch("/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone }),
      });

      const data = await res.json();
      if (!res.ok) throw new Error(data.message);

      showToast("success", data.message);
      closeLoginModal();
      setTimeout(() => openOtpModal(phone), 250);

    } catch (err) {
      showToast("error", err.message || "Login failed");
    } finally {
      setLoginLoading(false);
    }
  });


  function openOtpModal(phone) {
    currentPhone = phone;
    otpPhoneText.innerText = `+91 ${phone}`;

    otpModal.classList.remove("hidden");
    otpModal.classList.add("flex");

    setupOtpInputs();
    startOtpTimer();
  }

  // Close otp model
  window.closeOtpModal = () => {
    otpModal.classList.add("hidden");
    otpModal.classList.remove("flex");
    clearInterval(otpTimer);
  };

  function setupOtpInputs() {
    const inputs = document.querySelectorAll(".otp-input");

    inputs.forEach((input, i) => {
      input.value = "";

      input.oninput = () => {
        input.value = input.value.replace(/\D/g, "");
        if (input.value && i < inputs.length - 1) inputs[i + 1].focus();
      };

      input.onkeydown = (e) => {
        if (e.key === "Backspace" && !input.value && i > 0) {
          inputs[i - 1].focus();
        }
      };
    });

    inputs[0]?.focus();
  }

  // Start otp timer
  function startOtpTimer() {
    clearInterval(otpTimer);
    remainingSeconds = 120;
    resendOtpBtn.classList.add("hidden");

    otpTimer = setInterval(() => {
      remainingSeconds--;
      const m = String(Math.floor(remainingSeconds / 60)).padStart(2, "0");
      const s = String(remainingSeconds % 60).padStart(2, "0");
      otpTimerEl.innerText = `${m}:${s}`;

      if (remainingSeconds <= 0) {
        clearInterval(otpTimer);
        otpTimerEl.innerText = "";
        resendOtpBtn.classList.remove("hidden");
      }
    }, 1000);
  }

  // Resend otp
  window.resendOtp = async () => {
    try {
      const res = await fetch("/auth/resend-otp", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone: currentPhone }),
      });

      if (!res.ok) throw new Error();
      showToast("success", "OTP resent");
      startOtpTimer();
    } catch {
      showToast("error", "Failed to resend OTP");
    }
  };

  // Verify otp
  window.verifyOtp = async () => {
    const otp = [...document.querySelectorAll(".otp-input")]
      .map(i => i.value)
      .join("");

    if (otp.length !== 6) {
      showToast("error", "Enter valid OTP");
      return;
    }

    try {
      const res = await fetch("/auth/verify-otp", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone: currentPhone, otp }),
      });

      if (!res.ok) throw new Error();
      location.reload();
    } catch {
      showToast("error", "Invalid OTP");
    }
  };

  /* =======================
     PROFILE DROPDOWN
  ======================= */

  profileBtn?.addEventListener("click", (e) => {
    e.stopPropagation();
    dropdownOpen = !dropdownOpen;

    profileDropdown.classList.toggle("opacity-0", !dropdownOpen);
    profileDropdown.classList.toggle("scale-95", !dropdownOpen);
    profileDropdown.classList.toggle("pointer-events-none", !dropdownOpen);
  });

  document.addEventListener("click", () => {
    dropdownOpen = false;
    profileDropdown.classList.add("opacity-0", "scale-95", "pointer-events-none");
  });


  window.openVideo = (src) => {
    videoPlayer.src = src;
    videoModal.classList.remove("hidden");
    videoModal.classList.add("flex");
    videoPlayer.play();
  };

  window.closeVideo = () => {
    videoPlayer.pause();
    videoPlayer.src = "";
    videoModal.classList.add("hidden");
    videoModal.classList.remove("flex");
  };

  /* =======================
     GLOBAL ESC HANDLER
  ======================= */

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      closeLoginModal();
      closeOtpModal();
      closeVideo();
    }
  });

});
</script>

<!-- Toast script -->
<%- include("../partials/toast-script.ejs") %>
</body>
</html>

